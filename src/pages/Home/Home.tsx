import { useState, useEffect } from 'react';
import './Home.scss';
import '../../assets/wxqr.webp';

const Home: React.FC = () => {
  const [visibleCards, setVisibleCards] = useState<number[]>([]);

  // 获得当前年
  const now = new Date();
  const year = now.getFullYear();

  const platforms = [
    {
      name: 'Web',
      delay: 0,
      bref_info:
        'Web开发的魅力在于，你的每一行代码都可能改变数百万用户的体验。刚开始可能会觉得繁杂，但一旦上手，你会发现Web让你的创造力得到了最大化的发挥！',
    },
    {
      name: 'Server',
      delay: 100,
      bref_info:
        '服务器开发让你能够处理后端逻辑，保障应用的稳定和安全。了解服务器的构建，能让你的应用运行得更顺畅！',
    },
    {
      name: 'Android',
      delay: 200,
      bref_info:
        '安卓开发为你打开了移动应用的大门，应用程序的每一次更新都能提升用户体验，快来尝试吧！',
    },
    {
      name: 'iOS',
      delay: 300,
      bref_info:
        'iOS开发注重用户体验，精致的界面让每个应用都独具魅力。用你的创意实现应用的灵魂！',
    },
    {
      name: 'HarmonyOS',
      delay: 400,
      bref_info:
        '鸿蒙系统为多设备体验提供了可能，了解其特性，你将能够创建跨平台的应用！',
    },
  ];

  // 使用IntersectionObserver 接口监听元素是否进入视口，并实现只要进入视口反复出现动画
  useEffect(() => {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          // 元素进入视口，添加动画类名
          entry.target.classList.add('show');
        } else {
          // 元素离开视口，移除动画类名
          entry.target.classList.remove('show');
        }
      });
    });

    const cards = document.querySelectorAll('.platform-card');
    cards.forEach((card) => {
      observer.observe(card);
    });

    return () => {
      observer.disconnect();
    };
  }, []);

  // 实现即将滚动到platforms-section时卡片依次弹出
  // useEffect(() => {
  //   const handleScroll = () => {
  //     const platformsSection = document.querySelector('.platforms-section');
  //     if (platformsSection) {
  //       const sectionTop = platformsSection.getBoundingClientRect().top;
  //       const windowHeight = window.innerHeight;

  //       if (sectionTop < windowHeight * 0.9) {
  //         platforms.forEach((platform, index) => {
  //           setTimeout(() => {
  //             setVisibleCards((prev) => [...new Set([...prev, index])]);
  //           }, platform.delay);
  //         });
  //       }
  //     }
  //   };

  //   window.addEventListener('scroll', handleScroll);
  //   return () => window.removeEventListener('scroll', handleScroll);
  // }, []);

  return (
    <div className="home-container">
      <section className="hero">
        <div className="hero-content">
          <div className="hero-gif">
            {/* < img src="./src/assets/layoutback.gif" alt="" /> */}
            <video autoPlay loop muted>
              <source src="./src/assets/layoutback.mp4" type="video/mp4" />
              Your browser does not support the video tag.
            </video>
          </div>
          <div className="hero-tip">
            <h1>
              {/* <svg
                className="icon"
                viewBox="0 0 1024 1024"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                p-id="2081"
                width="70"
                height="70"
              >
                <path
                  d="M136.672869 338.304579c-41.732506 0-75.684744 33.705155-75.684745 75.133954v249.997531c0 41.732506 33.952238 75.68646 75.684745 75.68646 20.255122 0 39.191894-7.891227 53.323121-22.22035 14.037428-14.232463 21.76908-33.219567 21.76908-53.46611V413.438533c0-41.429372-33.685708-75.133954-75.09163-75.133954z m43.486684 325.132629c0 24.718639-19.100922 44.080371-43.486684 44.080371-24.305117 0-44.079799-19.774682-44.079799-44.080371V413.439677c0-24.001982 19.774682-43.529009 44.08037-43.529009 23.978532 0 43.486112 19.527027 43.486113 43.529009v249.997531z m484.562643-565.283428l33.73032-62.230137c3.054798-5.446131 3.945328-11.756481 2.506868-17.797442-1.527113-6.416734-5.668048-11.966388-11.356687-15.225945l-0.800733-0.459278-0.849922-0.362617c-11.785651-5.033181-25.360369-0.650882-31.57406 10.196767l-35.227691 64.565418c-34.713507-13.423723-71.567259-20.217945-109.771391-20.217945-38.204704 0-75.0596 6.794794-109.771392 20.218517l-35.068117-64.28173-0.160146-0.285976c-6.213691-10.845933-19.787265-15.227661-31.57406-10.195051l-0.847634 0.362617-0.800733 0.457562c-11.461926 6.567157-15.40325 21.3384-8.851535 33.021672l33.710874 62.195819c-37.134009 21.681571-68.45355 51.158282-91.187514 85.970164-26.461949 40.518251-40.448473 87.154106-40.448473 134.863515v15.802472h569.406061v-15.803044c0-47.664225-13.951635-94.292643-40.346666-134.843497-22.643023-34.786716-53.797842-64.25542-90.717369-85.951289zM258.579945 303.146093c5.807033-76.954479 53.741219-146.705789 128.017817-184.650255l11.98469-6.12275 2.365595-1.049533c34.531626-15.32432 71.685653-23.093722 110.430853-23.093721 38.744627 0 75.898655 7.769401 110.429708 23.093721l2.958138 1.312631 11.35497 5.840778c73.951157 38.034834 121.677152 107.791864 127.463595 184.670273h-505.005366z m-29.869069 449.24687c0 21.376721 8.275007 41.424796 23.302484 56.45113 15.026333 15.027477 35.074409 23.302484 56.451129 23.302484h27.283845l0.522193 116.168107c0 41.733078 33.68628 75.685316 75.09163 75.685316 41.733078 0 75.685316-33.952238 75.685316-75.685316v-116.168107h48.662853v116.168107c0 41.733078 33.95281 75.685316 75.685317 75.685316s75.684744-33.952238 75.684744-75.685316v-116.168107h27.807753c43.649119 0 79.160499-35.777338 79.160499-79.753614V349.364994H228.710876v403.027398z m31.604945-371.42188h502.126729v371.42188c0 26.549458-21.333824 48.148096-47.555554 48.148097h-59.412698v147.773624c0 24.305689-19.774682 44.080371-44.080371 44.080371s-44.079227-19.774682-44.079227-44.080371v-147.773624H455.442527v147.773624c0 24.305689-19.77411 44.080371-44.079799 44.080371-23.979104 0-43.486684-19.774682-43.486684-44.150721l-0.663465-147.70213H308.463917c-26.549458 0-48.148668-21.598638-48.148668-48.148097V380.970511z m128.373571-204.460969c-12.206036 0-22.07965 10.467873-22.07965 22.673908 0 12.204892 9.874758 22.673337 22.07965 22.673337 12.798579 0 22.673337-10.467301 22.673336-22.673337 0-12.205464-9.874758-22.673337-22.673336-22.673336z m245.379015 0c-12.799151 0-22.673909 10.467873-22.673908 22.673908 0 12.204892 9.874758 22.673337 22.673908 22.673337 12.204892 0 22.079078-10.467301 22.079079-22.673337 0-12.205464-9.874186-22.673337-22.079079-22.673336z m306.541317 183.589854c-14.235895-14.054586-33.225858-21.794818-53.471829-21.794818-41.406493 0-75.09163 33.705155-75.09163 75.133955v249.997531c0 41.732506 33.68628 75.68646 75.09163 75.68646 41.732506 0 75.68646-33.953954 75.68646-75.68646V413.438533c-0.000572-20.253406-7.890083-39.196469-22.214631-53.339137z m-9.391458 303.337812c0 24.305689-19.775254 44.080371-44.080371 44.080371-23.979104 0-43.48554-19.774682-43.485541-44.080371V413.439677c0-24.001982 19.50758-43.529009 43.485541-43.529009 24.718067 0 44.080371 19.120368 44.080371 43.529009v249.997531zM686.284229 406.245659a60.153949 60.153949 0 0 1-17.082502 37.8255A59.970924 59.970924 0 0 1 631.376799 461.153089a58.567925 58.567925 0 0 1 54.90743-54.90743zM673.35067 485.556582a37.641903 37.641903 0 0 0-19.827874 5.734966 39.716374 39.716374 0 0 1-41.912671 0A37.458878 37.458878 0 0 0 591.782251 485.556582h-2.013272c-19.766675 1.03695-37.703102 24.403493-37.703102 48.806413L569.605941 534.744488l8.007333-10.867096 4.57562 10.295143 13.726857-20.590286 7.435381 25.737858 8.579286-11.439048 4.003667 8.579286 5.147571-3.431715 5.719524 5.719524 17.158572 1.143905-17.158572 2.859762-4.575619-4.003667-5.719524 6.291477-5.147571-6.291477-8.007334 12.011001-8.579286-17.158572-10.867095 18.874429-4.575619-9.151238-26.881763 0.571952c0 25.745293 8.602164 45.756191 28.59762 61.198906 11.713585 12.20146 13.299609 12.20146 16.716452 12.20146a14.337131 14.337131 0 0 0 5.307719-0.97575 83.154443 83.154443 0 0 1 59.42185 0 13.848683 13.848683 0 0 0 5.246519 0.97575c3.416844 0 5.002868 0 16.838278-12.20146a113.231131 113.231131 0 0 0 20.010899-32.174038 61.618147 61.618147 0 0 1-26.477392-50.759059 62.22842 62.22842 0 0 1 9.577914-33.066284 30.503937 30.503937 0 0 0-12.20146-3.47747h-2.074471m0-24.403493h3.355644a61.374495 61.374495 0 0 1 46.122241 27.697939 36.604953 36.604953 0 0 0-20.376948 33.249308 35.934053 35.934053 0 0 0 32.578409 36.604953 120.857544 120.857544 0 0 1-33.066284 59.544248c-12.20146 12.750535-19.949699 19.888501-34.469855 19.8885a39.777573 39.777573 0 0 1-14.031708-2.562346 58.201876 58.201876 0 0 0-41.912671 0 39.533349 39.533349 0 0 1-14.031708 2.562346c-14.458956 0-22.268394-7.137966-34.408656-19.8885-21.902345-22.939295-35.506805-48.806986-35.506805-83.947741s26.416193-71.31846 61.007874-73.209906h3.294446a61.679346 61.679346 0 0 1 32.761433 9.456661 15.37408 15.37408 0 0 0 16.045552 0 61.679346 61.679346 0 0 1 32.578409-9.456661z"
                  p-id="2082"
                  fill="#5DE31C"
                ></path>
              </svg> */}
              西邮移动应用开发实验室
            </h1>
            <p>探索移动应用开发的无限可能</p>
          </div>
        </div>
      </section>

      <section className="platforms-section">
        <h2>技术平台</h2>
        <div className="platforms-container">
          {platforms.map((platform) => (
            <div
              className={`platform-card ${platform.delay ? `transition-delay-${platform.delay}` : ''}`}
              style={{
                transitionDelay: `${platform.delay}ms`,
              }}
            >
              <h3>{platform.name}</h3>
              <div className="platform-description">{platform.bref_info}</div>
            </div>
          ))}
        </div>
      </section>

      <footer className="home-footer">
        <div className="footer-links">
          <div className="vx">微信公众号</div>
          <img src="./src/assets/wxqr.webp" alt="" />
          <div className="qq">qq纳新群: 1623728627</div>
        </div>
        <div className="copyright">
          © {year} 西邮移动应用开发实验室. All rights reserved.
        </div>
      </footer>
    </div>
  );
};

export default Home;
