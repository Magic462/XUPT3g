<!DOCTYPE html>
<!-- saved from url=(0071)https://mpbeta.csdn.net/mp_blog/creation/editor?spm=1000.2115.3001.4503 -->
<html dir="ltr" lang="zh-cn" style="overflow-y: hidden;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title data-cke-title="null">null</title><style data-cke-temp="1">html{cursor:text;*cursor:auto;overflow:hidden;}
img,input,textarea{cursor:default}</style><link type="text/css" rel="stylesheet" href="./contents-mp.css"><link type="text/css" rel="stylesheet" href="./ck_htmledit_v1.css"><link type="text/css" rel="stylesheet" href="./imagebase.css"><link type="text/css" rel="stylesheet" href="./ck_htmledit_v2.css"><link type="text/css" rel="stylesheet" href="./tableselection.css"><link type="text/css" rel="stylesheet" href="./chart.css"><link type="text/css" rel="stylesheet" href="./inscode.css"><link type="text/css" rel="stylesheet" href="./atom-one-dark.css"><style data-cke-temp="1">.cke_editable{cursor:text}.cke_editable img,.cke_editable input,.cke_editable textarea{cursor:default}
.img-upload-box{margin:0 auto;width:420px;height:80px;-webkit-box-sizing:border-box;box-sizing:border-box;padding:8px;border:1px solid #e0e0e0;background-color:#fff;display:-webkit-box;display:-ms-flexbox;display:flex}.img-upload-box span.preview{display:block;width:64px;height:64px;background-repeat: no-repeat;background-size: contain;background-position: center;}.img-upload-box span.info-box{margin-left:16px}.img-upload-box span.info-box img.info-box{display:block;width:316px;height:3px;}.img-upload-box span.info-box span.operate-box{display:-webkit-box;display:-ms-flexbox;display:flex;margin-top:20px;line-height:20px}.img-upload-box span.info-box span.operate-box span.upload-msg{font-size:14px;color: #fc5531;width:100%;text-align:center}.img-upload-box span.info-box span.operate-box span.btn{margin-left:auto;font-size:14px;color:#999;white-space:nowrap;cursor:pointer}.img-upload-box span.info-box span.operate-box span.btn.btn-redo{display:none;margin-right:16px}
.htmledit_views .csdn-data-video{width:200px}.htmledit_views .csdn-data-video img{margin:0;display:block;width:200px;height:112px}.htmledit_views .csdn-data-video p{margin-top:10px;margin-bottom:0;font-size:14px}
.cke_widget_image .cke_widget_drag_handler_container { background: unset !important; height: 100%; width: 100%;} .cke_widget_wrapper.cke_widget_image:hover>.cke_widget_drag_handler_container{ height: 100% } .cke_widget_image .cke_widget_drag_handler_container img.cke_widget_drag_handler { height: 100%; width: 100%;}
.cke_show_borders  table.cke_show_border,.cke_show_borders  table.cke_show_border > tr > td, .cke_show_borders  table.cke_show_border > tr > th,.cke_show_borders  table.cke_show_border > tbody > tr > td, .cke_show_borders  table.cke_show_border > tbody > tr > th,.cke_show_borders  table.cke_show_border > thead > tr > td, .cke_show_borders  table.cke_show_border > thead > tr > th,.cke_show_borders  table.cke_show_border > tfoot > tr > td, .cke_show_borders  table.cke_show_border > tfoot > tr > th{border : #d3d3d3 1px dotted}
.cke_widget_wrapper{position:relative;outline:none}.cke_widget_inline{display:inline-block}.cke_widget_wrapper:hover>.cke_widget_element{outline:2px solid #ffd25c;cursor:default}.cke_widget_wrapper:hover .cke_widget_editable{outline:2px solid #ffd25c}.cke_widget_wrapper.cke_widget_focused>.cke_widget_element,.cke_widget_wrapper .cke_widget_editable.cke_widget_editable_focused{outline:2px solid #47a4f5}.cke_widget_editable{cursor:text}.cke_widget_drag_handler_container{position:absolute;width:15px;height:0;display:block;opacity:0.75;transition:height 0s 0.2s;line-height:0}.cke_widget_wrapper:hover>.cke_widget_drag_handler_container{height:15px;transition:none}.cke_widget_drag_handler_container:hover{opacity:1}.cke_editable[contenteditable="false"] .cke_widget_drag_handler_container{display:none;}img.cke_widget_drag_handler{cursor:move;width:15px;height:15px;display:inline-block}.cke_widget_mask{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.cke_widget_partial_mask{position:absolute;display:block}.cke_editable.cke_widget_dragging, .cke_editable.cke_widget_dragging *{cursor:move !important}
.cke_upload_uploading img{opacity: 0.3}
[data-cke-editorplaceholder]::before {position: absolute;opacity: .8;color: #aaa;white-space: pre;content: attr( data-cke-editorplaceholder );}.cke_wysiwyg_div[data-cke-editorplaceholder]::before {margin-top: 1em;}
.cke_image_nocaption{line-height:0}.cke_editable.cke_image_sw, .cke_editable.cke_image_sw *{cursor:sw-resize !important}.cke_editable.cke_image_se, .cke_editable.cke_image_se *{cursor:se-resize !important}.cke_image_resizer{display:none;position:absolute;width:10px;height:10px;bottom:-5px;right:-5px;background:#000;outline:1px solid #fff;line-height:0;cursor:se-resize;z-index:9;}.cke_image_resizer_wrapper{position:relative;display:inline-block;line-height:0;}.cke_image_resizer.cke_image_resizer_left{right:auto;left:-5px;cursor:sw-resize;}.cke_widget_wrapper:hover .cke_image_resizer,.cke_image_resizer.cke_image_resizing{display:block}.cke_widget_edit_container{display:none;position:absolute;padding:4px 24px;line-height:20px;bottom:48px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,.5);color:#fff;border-radius:8px;cursor:pointer;white-space: nowrap;}.cke_widget_wrapper:hover .cke_widget_edit_container{display:inline-block}.cke_editable[contenteditable="false"] .cke_image_resizer{display:none;}.cke_widget_wrapper>a{display:inline-block}
.cke_widget_wrapper_has-card {  margin: 0 auto;  display: block;  width: 640px;  overflow: hidden;}.cke_widget_csdnlink.cke_widget_focused>.cke_widget_element{  border: none;  outline: none;}.cke_widget_csdnlink>.cke_widget_element{  display: inline;  color: #6795B5;  text-decoration: none;}.cke_widget_csdnlink>.cke_widget_editable_focused {  outline: none !important;}.cke_widget_csdnlink>.cke_widget_editable_focused.has-card .link-card-box{  border-color: #409EFF;}.cke_widget_csdnlink:hover>.cke_widget_element{  cursor: text;  border: none;  outline: none !important;  color: #409EFF;  text-decoration: underline;}.cke_widget_csdnlink>.cke_widget_element.has-card{  display: block;}.cke_widget_csdnlink>.cke_widget_element.has-card:hover{  text-decoration: none!important;  color: unset;}.cke_widget_csdnlink .link-card-box{  margin: 8px auto 16px;  padding: 8px 16px;  display: block;  background: #F5F7FA;  border-radius: 4px;  border: 1px solid #DBDBDB;  cursor: pointer;}.cke_widget_csdnlink .link-card-box:hover{  border-color: #409EFF;}.cke_widget_csdnlink .link-card-box span{  display: block;}.cke_widget_csdnlink .link-card-box .link-title{  margin-bottom: 8px;  color: #222226;  overflow: hidden;  text-overflow: ellipsis;  white-space: nowrap;  font-size: 16px;  font-weight: 500;  line-height: 26px;}.cke_widget_csdnlink .link-card-box .link-desc{  display: -webkit-box;  -webkit-line-clamp: 2;  -webkit-box-orient: vertical;  margin-bottom: 8px;  max-height: 40px;  font-size: 14px;  font-weight: 400;  color: #999AAA;  line-height: 20px;  overflow: hidden;  word-break: break-all;}.cke_widget_csdnlink .link-card-box .link-link{  color: #409EFF;  overflow: hidden;  text-overflow: ellipsis;  white-space: nowrap;  font-size: 14px;  line-height: 1;  background-size: 14px 14px;  background-repeat: no-repeat;}.cke_widget_csdnlink .link-card-box .link-link img{  margin-right: 8px;  display: inline-block;  width: 14px;  height: 14px;  vertical-align: -2px;}</style></head><body class="htmledit_views cke_editable cke_editable_themed cke_contents_ltr cke_show_borders" contenteditable="true" spellcheck="false" style="height: auto; min-height: auto;"><blockquote><p>轮播图：实现无限循环轮播图的关键在于"视觉欺骗"——我们在实际数据的前后各添加部分数据副本，当滚动到边缘时快速而无缝地跳转到另一端，从而创造出无限循环的视觉效果。<br></p></blockquote><h1>理想效果</h1><p>轮播图理想效果：呈现多个元素盒子，并且首元素默认初次呈现居中效果，通过左右按钮控制轮播图的滑动，滑动一次下一个元素又再次居中，居中元素有一个居中动画效果</p><p>静态效果：</p><p><span tabindex="-1" contenteditable="false" data-cke-widget-wrapper="1" data-cke-filter="off" class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption" data-cke-display-name="图像" data-cke-widget-id="19" role="region" aria-label=" 图像 小部件"><img data-cke-saved-src="https://i-blog.csdnimg.cn/direct/f22c8d0cb90b4f5f98a8eb37b720c9f4.png" src="./f22c8d0cb90b4f5f98a8eb37b720c9f4.png" width="1638" height="240" data-cke-widget-data="%7B%22hasCaption%22%3Afalse%2C%22src%22%3A%22https%3A%2F%2Fi-blog.csdnimg.cn%2Fdirect%2Ff22c8d0cb90b4f5f98a8eb37b720c9f4.png%22%2C%22alt%22%3A%22%22%2C%22width%22%3A%221638%22%2C%22height%22%3A%22240%22%2C%22lock%22%3Atrue%2C%22align%22%3A%22none%22%2C%22classes%22%3Anull%7D" data-cke-widget-upcasted="1" data-cke-widget-keep-attr="0" data-widget="image" class="cke_widget_element" isbindedload="true" alt=""><span class="cke_reset cke_widget_drag_handler_container" style="background: url(&quot;https://csdnimg.cn/release/blog_editor_html/release2.3.8/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); top: 0px; left: 0px;"><img class="cke_reset cke_widget_drag_handler" data-cke-widget-drag-handler="1" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" width="15" title="点击并拖拽以移动" height="15" role="presentation" draggable="true"></span><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span><span class="cke_widget_edit_container" title="编辑图片">编辑</span></span><br></p><h1>思路</h1><ol><li>首先在scss里面将track盒子居中，最外层盒子设置overflow:hidden，注意：这里尽量不要去使用transform去让track居中，不然后续ts去控制盒子移动这个效果会被抵消</li><li>dang'q</li></ol><h1>数据结构准备</h1><div tabindex="-1" contenteditable="false" data-cke-widget-wrapper="1" data-cke-filter="off" class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet" data-cke-display-name="代码段" data-cke-widget-id="18" role="region" aria-label="代码段 小部件"><pre data-cke-widget-keep-attr="0" data-widget="codeSnippet" class="cke_widget_element" data-cke-widget-data="%7B%22classes%22%3Anull%2C%22lang%22%3A%22TypeScript%22%2C%22code%22%3A%22const%20carouselData%20%3D%20%5B%5Cn%20%20%7B%5Cn%20%20%20%20title%3A%20&#39;00&#39;%2C%5Cn%20%20%20%20midOrder%3A%20-2%2C%5Cn%20%20%7D%2C%5Cn%20%20%7B%5Cn%20%20%20%20title%3A%20&#39;11&#39;%2C%5Cn%20%20%20%20midOrder%3A%20-1%2C%5Cn%20%20%7D%2C%5Cn%20%20%7B%5Cn%20%20%20%20title%3A%20&#39;22&#39;%2C%5Cn%20%20%20%20midOrder%3A%200%2C%5Cn%20%20%7D%2C%5Cn%20%20%7B%5Cn%20%20%20%20title%3A%20&#39;33&#39;%2C%5Cn%20%20%20%20midOrder%3A%201%2C%5Cn%20%20%7D%2C%5Cn%20%20%7B%5Cn%20%20%20%20title%3A%20&#39;44&#39;%2C%5Cn%20%20%20%20midOrder%3A%202%2C%5Cn%20%20%7D%2C%5Cn%5D%3B%22%7D"><code class="hljs language-TypeScript"><span class="hljs-keyword">const</span> carouselData = [
  {
    <span class="hljs-attr">title</span>: <span class="hljs-string">'00'</span>,
    <span class="hljs-attr">midOrder</span>: -<span class="hljs-number">2</span>,
  },
  {
    <span class="hljs-attr">title</span>: <span class="hljs-string">'11'</span>,
    <span class="hljs-attr">midOrder</span>: -<span class="hljs-number">1</span>,
  },
  {
    <span class="hljs-attr">title</span>: <span class="hljs-string">'22'</span>,
    <span class="hljs-attr">midOrder</span>: <span class="hljs-number">0</span>,
  },
  {
    <span class="hljs-attr">title</span>: <span class="hljs-string">'33'</span>,
    <span class="hljs-attr">midOrder</span>: <span class="hljs-number">1</span>,
  },
  {
    <span class="hljs-attr">title</span>: <span class="hljs-string">'44'</span>,
    <span class="hljs-attr">midOrder</span>: <span class="hljs-number">2</span>,
  },
];</code></pre><span class="cke_reset cke_widget_drag_handler_container" style="background: url(&quot;https://csdnimg.cn/release/blog_editor_html/release2.3.8/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); top: 0px; left: 0px;"><img class="cke_reset cke_widget_drag_handler" data-cke-widget-drag-handler="1" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" width="15" title="点击并拖拽以移动" height="15" role="presentation"></span></div><h2>组件实现步骤</h2><h3>1. 扩展数据创建"视觉循环"</h3><div tabindex="-1" contenteditable="false" data-cke-widget-wrapper="1" data-cke-filter="off" class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet" data-cke-display-name="代码段" data-cke-widget-id="21" role="region" aria-label="代码段 小部件"><pre data-cke-widget-keep-attr="0" data-widget="codeSnippet" class="cke_widget_element" data-cke-widget-data="%7B%22classes%22%3Anull%2C%22lang%22%3A%22TypeScript%22%2C%22code%22%3A%22const%20slides%20%3D%20%5B%5Cn%20%C2%A0carouselData%5BcarouselData.length%20-%203%5D%2C%5Cn%20%C2%A0carouselData%5BcarouselData.length%20-%202%5D%2C%5Cn%20%C2%A0carouselData%5BcarouselData.length%20-%201%5D%2C%5Cn%20%C2%A0...carouselData%2C%5Cn%20%C2%A0carouselData%5B0%5D%2C%5Cn%20%C2%A0carouselData%5B1%5D%2C%5Cn%20%C2%A0carouselData%5B2%5D%2C%5Cn%5D%3B%22%7D"><code class="hljs language-TypeScript"><span class="hljs-keyword">const</span> slides = [
 &nbsp;carouselData[carouselData.<span class="hljs-property">length</span> - <span class="hljs-number">3</span>],
 &nbsp;carouselData[carouselData.<span class="hljs-property">length</span> - <span class="hljs-number">2</span>],
 &nbsp;carouselData[carouselData.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>],
 &nbsp;...carouselData,
 &nbsp;carouselData[<span class="hljs-number">0</span>],
 &nbsp;carouselData[<span class="hljs-number">1</span>],
 &nbsp;carouselData[<span class="hljs-number">2</span>],
];</code></pre><span class="cke_reset cke_widget_drag_handler_container" style="background: url(&quot;https://csdnimg.cn/release/blog_editor_html/release2.3.8/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); top: 0px; left: 0px;"><img class="cke_reset cke_widget_drag_handler" data-cke-widget-drag-handler="1" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" width="15" title="点击并拖拽以移动" height="15" role="presentation"></span></div><p>在原始数据前后各添加3个数据项，这样当滚动到"边缘"时，可以无缝跳转。</p><h3>2. 状态管理</h3><div tabindex="-1" contenteditable="false" data-cke-widget-wrapper="1" data-cke-filter="off" class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet" data-cke-display-name="代码段" data-cke-widget-id="22" role="region" aria-label="代码段 小部件"><pre data-cke-widget-keep-attr="0" data-widget="codeSnippet" class="cke_widget_element" data-cke-widget-data="%7B%22classes%22%3Anull%2C%22lang%22%3A%22TypeScript%22%2C%22code%22%3A%22const%20%5BcurrentIndex%2C%20setCurrentIndex%5D%20%3D%20useState(-2)%3B%5Cnconst%20%5BslideWidth%2C%20setSlideWidth%5D%20%3D%20useState(0)%3B%5Cnconst%20trackRef%20%3D%20useRef%3CHTMLDivElement%3E(null)%3B%22%7D"><code class="hljs language-TypeScript"><span class="hljs-keyword">const</span> [currentIndex, setCurrentIndex] = <span class="hljs-title function_">useState</span>(-<span class="hljs-number">2</span>);
<span class="hljs-keyword">const</span> [slideWidth, setSlideWidth] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">const</span> trackRef = useRef&lt;<span class="hljs-title class_">HTMLDivElement</span>&gt;(<span class="hljs-literal">null</span>);</code></pre><span class="cke_reset cke_widget_drag_handler_container" style="background: url(&quot;https://csdnimg.cn/release/blog_editor_html/release2.3.8/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); top: 0px; left: 0px;"><img class="cke_reset cke_widget_drag_handler" data-cke-widget-drag-handler="1" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" width="15" title="点击并拖拽以移动" height="15" role="presentation"></span></div><ul><li><p><code>currentIndex</code> 表示当前中心项的索引</p></li><li><p><code>slideWidth</code> 存储每个轮播项的宽度</p></li><li><p><code>trackRef</code> 用于操作轮播轨道DOM元素</p></li></ul><h3>3. 计算轮播项宽度</h3><div tabindex="-1" contenteditable="false" data-cke-widget-wrapper="1" data-cke-filter="off" class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet" data-cke-display-name="代码段" data-cke-widget-id="23" role="region" aria-label="代码段 小部件"><pre data-cke-widget-keep-attr="0" data-widget="codeSnippet" class="cke_widget_element" data-cke-widget-data="%7B%22classes%22%3Anull%2C%22lang%22%3A%22TypeScript%22%2C%22code%22%3A%22useEffect(()%20%3D%3E%20%7B%5Cn%20%C2%A0const%20items%20%3D%20trackRef.current%3F.querySelectorAll(&#39;.activities-recent-item&#39;)%3B%5Cn%20%C2%A0if%20(!items%20%7C%7C%20items.length%20%3C%202)%20return%3B%5Cn%E2%80%8B%5Cn%20%C2%A0const%20first%20%3D%20items%5B0%5D.getBoundingClientRect()%3B%5Cn%20%C2%A0const%20second%20%3D%20items%5B1%5D.getBoundingClientRect()%3B%5Cn%20%C2%A0setSlideWidth(first.left%20-%20second.left)%3B%5Cn%7D%2C%20%5B%5D)%3B%22%7D"><code class="hljs language-TypeScript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
 &nbsp;<span class="hljs-keyword">const</span> items = trackRef.<span class="hljs-property">current</span>?.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.activities-recent-item'</span>);
 &nbsp;<span class="hljs-keyword">if</span> (!items || items.<span class="hljs-property">length</span> &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span>;
​
 &nbsp;<span class="hljs-keyword">const</span> first = items[<span class="hljs-number">0</span>].<span class="hljs-title function_">getBoundingClientRect</span>();
 &nbsp;<span class="hljs-keyword">const</span> second = items[<span class="hljs-number">1</span>].<span class="hljs-title function_">getBoundingClientRect</span>();
 &nbsp;<span class="hljs-title function_">setSlideWidth</span>(first.<span class="hljs-property">left</span> - second.<span class="hljs-property">left</span>);
}, []);</code></pre><span class="cke_reset cke_widget_drag_handler_container" style="background: url(&quot;https://csdnimg.cn/release/blog_editor_html/release2.3.8/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); top: 0px; left: 0px;"><img class="cke_reset cke_widget_drag_handler" data-cke-widget-drag-handler="1" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" width="15" title="点击并拖拽以移动" height="15" role="presentation"></span></div><p>这个效果通过比较相邻两个轮播项的位置来计算单个项的宽度。</p><h3>4. 处理导航点击</h3><div tabindex="-1" contenteditable="false" data-cke-widget-wrapper="1" data-cke-filter="off" class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet" data-cke-display-name="代码段" data-cke-widget-id="24" role="region" aria-label="代码段 小部件"><pre data-cke-widget-keep-attr="0" data-widget="codeSnippet" class="cke_widget_element" data-cke-widget-data="%7B%22classes%22%3Anull%2C%22lang%22%3A%22TypeScript%22%2C%22code%22%3A%22const%20handleDirection%20%3D%20(dir%3A%20&#39;left&#39;%20%7C%20&#39;right&#39;)%20%3D%3E%20%7B%5Cn%20%C2%A0if%20(dir%20%3D%3D%3D%20&#39;left&#39;)%20%7B%5Cn%20%C2%A0%20%C2%A0setCurrentIndex((prev)%20%3D%3E%20prev%20-%201)%3B%5Cn%20%20%7D%20else%20%7B%5Cn%20%C2%A0%20%C2%A0setCurrentIndex((prev)%20%3D%3E%20prev%20%2B%201)%3B%5Cn%20%20%7D%5Cn%7D%3B%22%7D"><code class="hljs language-TypeScript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">handleDirection</span> = (<span class="hljs-params">dir: <span class="hljs-string">'left'</span> | <span class="hljs-string">'right'</span></span>) =&gt; {
 &nbsp;<span class="hljs-keyword">if</span> (dir === <span class="hljs-string">'left'</span>) {
 &nbsp; &nbsp;<span class="hljs-title function_">setCurrentIndex</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev - <span class="hljs-number">1</span>);
  } <span class="hljs-keyword">else</span> {
 &nbsp; &nbsp;<span class="hljs-title function_">setCurrentIndex</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>);
  }
};</code></pre><span class="cke_reset cke_widget_drag_handler_container" style="background: url(&quot;https://csdnimg.cn/release/blog_editor_html/release2.3.8/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); top: 0px; left: 0px;"><img class="cke_reset cke_widget_drag_handler" data-cke-widget-drag-handler="1" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" width="15" title="点击并拖拽以移动" height="15" role="presentation"></span></div><p>点击左右按钮时，更新当前索引。</p><h3>5. 无限循环修正</h3><div tabindex="-1" contenteditable="false" data-cke-widget-wrapper="1" data-cke-filter="off" class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet" data-cke-display-name="代码段" data-cke-widget-id="25" role="region" aria-label="代码段 小部件"><pre data-cke-widget-keep-attr="0" data-widget="codeSnippet" class="cke_widget_element" data-cke-widget-data="%7B%22classes%22%3Anull%2C%22lang%22%3A%22TypeScript%22%2C%22code%22%3A%22useEffect(()%20%3D%3E%20%7B%5Cn%20%C2%A0const%20track%20%3D%20trackRef.current%3B%5Cn%20%C2%A0if%20(!track)%20return%3B%5Cn%E2%80%8B%5Cn%20%C2%A0if%20(currentIndex%20%3D%3D%3D%20-4)%20%7B%5Cn%20%C2%A0%20%C2%A0track.style.transition%20%3D%20&#39;none&#39;%3B%5Cn%20%C2%A0%20%C2%A0track.style.transform%20%3D%20%60translateX(%24%7B2%20*%20slideWidth%7Dpx)%60%3B%5Cn%20%C2%A0%20%C2%A0setCurrentIndex(2)%3B%5Cn%20%20%7D%20else%20if%20(currentIndex%20%3D%3D%3D%204)%20%7B%5Cn%20%C2%A0%20%C2%A0track.style.transition%20%3D%20&#39;none&#39;%3B%5Cn%20%C2%A0%20%C2%A0track.style.transform%20%3D%20%60translateX(%24%7B-2%20*%20slideWidth%7Dpx)%60%3B%5Cn%20%C2%A0%20%C2%A0setCurrentIndex(-2)%3B%5Cn%20%20%7D%20else%20%7B%5Cn%20%C2%A0%20%C2%A0track.style.transition%20%3D%20&#39;transform%200.4s%20ease&#39;%3B%5Cn%20%C2%A0%20%C2%A0track.style.transform%20%3D%20%60translateX(%24%7BcurrentIndex%20*%20slideWidth%7Dpx)%60%3B%5Cn%20%20%7D%5Cn%7D%2C%20%5BcurrentIndex%5D)%3B%22%7D"><code class="hljs language-TypeScript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
 &nbsp;<span class="hljs-keyword">const</span> track = trackRef.<span class="hljs-property">current</span>;
 &nbsp;<span class="hljs-keyword">if</span> (!track) <span class="hljs-keyword">return</span>;
​
 &nbsp;<span class="hljs-keyword">if</span> (currentIndex === -<span class="hljs-number">4</span>) {
 &nbsp; &nbsp;track.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">'none'</span>;
 &nbsp; &nbsp;track.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateX(<span class="hljs-subst">${<span class="hljs-number">2</span> * slideWidth}</span>px)`</span>;
 &nbsp; &nbsp;<span class="hljs-title function_">setCurrentIndex</span>(<span class="hljs-number">2</span>);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (currentIndex === <span class="hljs-number">4</span>) {
 &nbsp; &nbsp;track.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">'none'</span>;
 &nbsp; &nbsp;track.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateX(<span class="hljs-subst">${-<span class="hljs-number">2</span> * slideWidth}</span>px)`</span>;
 &nbsp; &nbsp;<span class="hljs-title function_">setCurrentIndex</span>(-<span class="hljs-number">2</span>);
  } <span class="hljs-keyword">else</span> {
 &nbsp; &nbsp;track.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">'transform 0.4s ease'</span>;
 &nbsp; &nbsp;track.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateX(<span class="hljs-subst">${currentIndex * slideWidth}</span>px)`</span>;
  }
}, [currentIndex]);</code></pre><span class="cke_reset cke_widget_drag_handler_container" style="background: url(&quot;https://csdnimg.cn/release/blog_editor_html/release2.3.8/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); top: 0px; left: 0px;"><img class="cke_reset cke_widget_drag_handler" data-cke-widget-drag-handler="1" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" width="15" title="点击并拖拽以移动" height="15" role="presentation"></span></div><p>当滚动到边缘时，我们：</p><ol><li><p>禁用过渡动画</p></li><li><p>立即跳转到另一端</p></li><li><p>重新启用动画</p></li></ol><h3>6. 渲染组件</h3><div tabindex="-1" contenteditable="false" data-cke-widget-wrapper="1" data-cke-filter="off" class="cke_widget_wrapper cke_widget_block cke_widget_codeSnippet" data-cke-display-name="代码段" data-cke-widget-id="26" role="region" aria-label="代码段 小部件"><pre data-cke-widget-keep-attr="0" data-widget="codeSnippet" class="cke_widget_element" data-cke-widget-data="%7B%22classes%22%3Anull%2C%22lang%22%3A%22TypeScript%22%2C%22code%22%3A%22return%20(%5Cn%20%C2%A0%3C%3E%5Cn%20%C2%A0%20%C2%A0%3Cdiv%20className%3D%5C%22rencent-to-left%20recent-to-button%5C%22%20onClick%3D%7B()%20%3D%3E%20handleDirection(&#39;left&#39;)%7D%3E%5Cn%20%C2%A0%20%C2%A0%20%C2%A0%3Ci%20className%3D%5C%22iconfont%20icon-zuojiantou%5C%22%3E%3C%2Fi%3E%5Cn%20%C2%A0%20%C2%A0%3C%2Fdiv%3E%5Cn%E2%80%8B%5Cn%20%C2%A0%20%C2%A0%3Cdiv%20className%3D%5C%22activities-recent-container%5C%22%3E%5Cn%20%C2%A0%20%C2%A0%20%C2%A0%3Cdiv%20ref%3D%7BtrackRef%7D%20className%3D%5C%22activities-recent-box%20track-box%5C%22%3E%5Cn%20%C2%A0%20%C2%A0%20%C2%A0%20%20%7Bslides.map((item)%20%3D%3E%20(%5Cn%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%3Cdiv%20className%3D%7B%60activities-recent-item%20%24%7Bitem.midOrder%20%3D%3D%3D%20currentIndex%20%3F%20&#39;mid-active&#39;%20%3A%20&#39;&#39;%7D%60%7D%3E%5Cn%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%20%7Bitem.title%7D%5Cn%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%3C%2Fdiv%3E%5Cn%20%C2%A0%20%C2%A0%20%C2%A0%20%20))%7D%5Cn%20%C2%A0%20%C2%A0%20%C2%A0%3C%2Fdiv%3E%5Cn%20%C2%A0%20%C2%A0%3C%2Fdiv%3E%5Cn%E2%80%8B%5Cn%20%C2%A0%20%C2%A0%3Cdiv%20className%3D%5C%22rencent-to-right%20recent-to-button%5C%22%20onClick%3D%7B()%20%3D%3E%20handleDirection(&#39;right&#39;)%7D%3E%5Cn%20%C2%A0%20%C2%A0%20%C2%A0%3Ci%20className%3D%5C%22iconfont%20icon-youjiantou%5C%22%3E%3C%2Fi%3E%5Cn%20%C2%A0%20%C2%A0%3C%2Fdiv%3E%5Cn%20%C2%A0%3C%2F%3E%5Cn)%3B%22%7D"><code class="hljs language-TypeScript"><span class="hljs-keyword">return</span> (
 &nbsp;<span class="language-xml"><span class="hljs-tag">&lt;&gt;</span>
 &nbsp; &nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"rencent-to-left recent-to-button"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handleDirection('left')}&gt;
 &nbsp; &nbsp; &nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"iconfont icon-zuojiantou"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>
 &nbsp; &nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
​
 &nbsp; &nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"activities-recent-container"</span>&gt;</span>
 &nbsp; &nbsp; &nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{trackRef}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"activities-recent-box track-box"</span>&gt;</span>
 &nbsp; &nbsp; &nbsp;  {slides.map((item) =&gt; (
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">activities-recent-item</span> ${<span class="hljs-attr">item.midOrder</span> === <span class="hljs-string">currentIndex</span> ? '<span class="hljs-attr">mid-active</span>' <span class="hljs-attr">:</span> ''}`}&gt;</span>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  {item.title}
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp; &nbsp; &nbsp;  ))}
 &nbsp; &nbsp; &nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp; &nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
​
 &nbsp; &nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"rencent-to-right recent-to-button"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handleDirection('right')}&gt;
 &nbsp; &nbsp; &nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"iconfont icon-youjiantou"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>
 &nbsp; &nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp;<span class="hljs-tag">&lt;/&gt;</span></span>
);</code></pre><span class="cke_reset cke_widget_drag_handler_container" style="background: url(&quot;https://csdnimg.cn/release/blog_editor_html/release2.3.8/ckeditor/plugins/widget/images/handle.png&quot;) rgba(220, 220, 220, 0.5); top: 0px; left: 0px;"><img class="cke_reset cke_widget_drag_handler" data-cke-widget-drag-handler="1" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" width="15" title="点击并拖拽以移动" height="15" role="presentation"></span></div><h2>关键点总结</h2><ol><li><p><strong>数据扩展</strong>：通过在原始数据前后添加副本，实现视觉上的无限循环</p></li><li><p><strong>无缝跳转</strong>：当滚动到边缘时，禁用动画并立即跳转</p></li><li><p><strong>精确计算</strong>：动态计算轮播项宽度确保滚动精度</p></li><li><p><strong>状态管理</strong>：使用React状态控制当前显示项</p></li><li><p><strong>CSS过渡</strong>：通过CSS实现平滑的滚动效果</p></li></ol> </body></html>