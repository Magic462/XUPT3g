"use strict";!function(t,s){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.iframe=null,this.options=t,this.env=t.env||"prod";var s={dev:"http://loc-mp-download.csdn.net",test:"https://test-upload.csdn.net",prod:"https://upload.csdn.net"};this.src=s[this.env]+"/source_upload",this.origin=s[this.env],this.successCallback=t.successCallback||function(){},this.unbindCallback=t.unbindCallback||function(){},this.successAutoClose=!1!==t.successAutoClose}e.prototype.create=function(t){var e=s.createElement("iframe");e.src=this.src,e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.border="none",e.style.zIndex=this.options.zIndex||1e3,this.iframe=e;var i=this;s.body.appendChild(this.iframe),window.addEventListener("message",function(t){(t.origin.indexOf("upload.csdn.net")>-1||t.origin.indexOf("download.csdn.net")>-1)&&(console.log("message trigger"),i.trigger(t.data))})},e.prototype.postMessage=function(t){t.action&&this.iframe&&this.iframe.contentWindow.postMessage(t,this.origin)},e.prototype.show=function(t){function s(){i.postMessage({action:"show",data:Object.assign({title:"",desc:"",successAutoClose:!0,tags:[]},i.options.data,e)})}var e=t||{},i=this;this.iframe?(i.iframe.style.display="block",setTimeout(function(){s()},600)):(this.create(this.env),this.iframe.onload=function(){s()})},e.prototype.close=function(t){this.postMessage({action:"close",data:{}}),"destroy"===t&&this.iframe?(s.body.removeChild(this.iframe),this.iframe=null):this.iframe&&(this.iframe.style.display="none")},e.prototype.trigger=function(t){"success"===t.action&&this.onSuccess(t.data),"close"===t.action&&this.close("destroy"),"unbind"===t.action&&this.unbindSource(t.data)},e.prototype.unbindSource=function(t){this.unbindCallback(t)},e.prototype.onSuccess=function(t){this.successCallback(t),this.successAutoClose&&this.close("destroy")},window._SourceUploadDialog=e,t.SourceUploadDialog=e}(window.csdn=window.csdn||{},document);