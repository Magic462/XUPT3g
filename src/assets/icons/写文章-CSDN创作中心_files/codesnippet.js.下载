/*
 Copyright (c) 2003-2018, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
*/
(function(){CKEDITOR.dialog.add("codeSnippet",function(f){function h(){var a=g.getElementsByTagName("li"),d;for(d in a)if(Object.hasOwnProperty.call(a,d)){var c=a[d];c.style.display="block";c.className="show"}}var e=f._.codesnippet.langs,l=f.lang.codesnippet,m=document.documentElement.clientHeight,k=[],c;k.push([f.lang.common.notSet,""]);var g=document.createElement("div");g.className="codesnippet-option-box";f="\x3cul class\x3d'codesnippet-option-list'\x3e";var d=-1;for(c in e)k.push([e[c],c]),f+=
"\x3cli class\x3d'show' title\x3d'"+e[c]+"' data-value\x3d'"+c+"'\x3e"+e[c]+"\x3c/li\x3e";g.innerHTML=f+"\x3c/ul\x3e";c=CKEDITOR.document.getWindow().getViewPaneSize();e=Math.min(c.width-70,740);c=c.height/1.6;650>m&&(c=m-220);g.style.maxHeight=c-48+"px";return{title:l.title,minHeight:200,resizable:CKEDITOR.DIALOG_RESIZE_NONE,contents:[{id:"info",elements:[{id:"lang",type:"text",className:"optbox",items:k,style:"color: #E0E0E0;margin-top: 0;",controlStyle:"position: absolute;right:24px;top: 59px;color:#fff;",
labelStyle:"margin-left: 0;",inputStyle:"background: transparent; color: white; width: 140px; height: 28px; line-height: 28px;",setup:function(a){a.ready&&a.data.lang&&(this.setValue(a.editor._.codesnippet.langs[a.data.lang]),this.getInputElement().setAttribute("data-value",a.data.lang));!CKEDITOR.env.gecko||a.data.lang&&a.ready||(this.getInputElement().$.selectedIndex=-1)},commit:function(a){a.setData("lang",this.getInputElement().getAttribute("data-value"))}},{id:"code",type:"textarea",className:"codebox",
setup:function(a){this.setValue(a.data.code);this.getInputElement().setAttribute("autocapitalize","off");this.getInputElement().setAttribute("spellcheck","false")},commit:function(a){a.setData("code",this.getValue())},required:!0,validate:CKEDITOR.dialog.validate.notEmpty(l.emptySnippetError),labelStyle:"line-height:0;display:none;",inputStyle:"cursor:auto;width:"+e+"px;height:"+c+"px;padding: 24px 16px 16px;tab-size:4;text-align:left;font-size: 14px;color: #CCCCCC;background: #272E39;font-family: Consolas,Inconsolata,Courier,monospace,PingFang SC,Microsoft YaHei,sans-serif;",
"class":"cke_source"}]}],onLoad:function(){var a=document.getElementsByClassName("codebox")[0].getElementsByTagName("textarea")[0];a.addEventListener("focus",function(b){g.style.display="none";d=-1;h()});a.addEventListener("keydown",function(b){9===b.keyCode&&(window.event?window.event.returnValue=!1:b.preventDefault(),window.event?window.event.cancelBubble=!0:b.stopPropagation(),b=this.selectionStart+4,this.value=this.value.substr(0,this.selectionStart)+"    "+this.value.substr(this.selectionStart),
this.selectionEnd=this.selectionStart=b,this.focus())},!1);var a=document.getElementsByClassName("optbox")[0],c=a.getElementsByTagName("input")[0];c.placeholder="选择代码语言";c.autocomplete="off";a.appendChild(g);c.addEventListener("focus",function(b){g.style.display="block"});var f=g.getElementsByTagName("li"),e;for(e in f)Object.hasOwnProperty.call(f,e)&&f[e].addEventListener("click",function(b){c.value=b.target.innerText;c.setAttribute("data-value",b.target.getAttribute("data-value"));b.target.classList.add("selected");
g.style.display="none";d=-1;h()});c.addEventListener("keydown",function(b){console.log(b.keyCode);13===b.keyCode&&(CKEDITOR.dialog.getCurrent().getButton("ok").disable(),window.event?window.event.returnValue=!1:b.preventDefault(),window.event?window.event.cancelBubble=!0:b.stopPropagation())},!1);c.addEventListener("keyup",function(b){if(38===b.keyCode||40===b.keyCode){window.event?window.event.returnValue=!1:b.preventDefault();window.event?window.event.cancelBubble=!0:b.stopPropagation();var a=g.getElementsByClassName("show");
-1!==d&&a[d].classList.remove("active");d=38===b.keyCode?d-1:d+1;d=-1>d?-1:d>a.length-1?0:d;a[d].classList.add("active")}else if(13===b.keyCode)window.event?window.event.returnValue=!1:b.preventDefault(),window.event?window.event.cancelBubble=!0:b.stopPropagation(),-1!==d&&(a=g.getElementsByClassName("show"),a[d].click()),setTimeout(function(){CKEDITOR.dialog.getCurrent().getButton("ok").enable()},200);else if(d=-1,b=c.value.trim().toLowerCase(),0<b.length){for(a in f)if(Object.hasOwnProperty.call(f,
a)){var e=f[a];-1===e.innerText.toLowerCase().indexOf(b)?(e.style.display="none",e.className=""):(e.style.display="block",e.className="show")}a=g.getElementsByClassName("show");0===a.length&&(c.value="",d=-1,h())}else d=-1,h()},!1)},onHide:function(){d=-1;h()}}})})();